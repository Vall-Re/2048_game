!function(){var t,e={};function r(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function n(t,e){var n=r(t,e,"get");return n.get?n.get.call(t):n.value}function i(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function a(t,e,r){i(t,e),e.set(t,r)}function o(t,e,n){var i=r(t,e,"set");return!function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,i,n),n}function s(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}function l(t,e){i(t,e),e.add(t)}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){if(t){if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(t,e)}}function f(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||c(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var h=/*#__PURE__*/new WeakMap,d=/*#__PURE__*/new WeakMap,v=/*#__PURE__*/new WeakMap,y=/*#__PURE__*/new WeakMap,m=/*#__PURE__*/new WeakSet,p=/*#__PURE__*/new WeakSet,g=/*#__PURE__*/new WeakSet,w=/*#__PURE__*/new WeakSet,S=/*#__PURE__*/new WeakSet,b=/*#__PURE__*/new WeakSet;function k(){return Array.from({length:4},function(){return[,,,,].fill(0)})}function O(){for(var t=[],e=0;e<4;e++)for(var r=0;r<4;r++)0===n(this,h)[e][r]&&t.push([e,r]);if(0!==t.length){var i,a=function(t){if(Array.isArray(t))return t}(i=t[Math.floor(Math.random()*t.length)])||function(t,e){var r,n,i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var a=[],o=!0,s=!1;try{for(i=i.call(t);!(o=(r=i.next()).done)&&(a.push(r.value),2!==a.length);o=!0);}catch(t){s=!0,n=t}finally{try{o||null==i.return||i.return()}finally{if(s)throw n}}return a}}(i,2)||c(i,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),o=a[0],s=a[1],l=.9>Math.random()?2:4;n(this,h)[o][s]=l}}function A(t){for(var e=f(t),r=t.filter(function(t){return 0!==t}),n=[],i=0,a=0;a<r.length;a++)if(r[a]===r[a+1]){var o=2*r[a];n.push(o),i+=o,a++}else n.push(r[a]);for(;n.length<4;)n.push(0);var s=JSON.stringify(e)!==JSON.stringify(n);return{newRow:n,scoreGained:i,changed:s}}function N(t){var e=this;if("playing"===n(this,v)){var r=function(t){return t.map(function(t){return f(t).reverse()})},i=function(t){return t[0].map(function(e,r){return t.map(function(t){return t[r]})})},a=JSON.parse(JSON.stringify(n(this,h))),l=!1,u=0;"right"===t?a=r(a):"up"===t?a=i(a):"down"===t&&(a=r(a=i(a)));var c=a.map(function(t){var r=s(e,g,A).call(e,t),n=r.newRow,i=r.scoreGained;return r.changed&&(l=!0),u+=i,n});"right"===t?c=r(c):"up"===t?c=i(c):"down"===t&&(c=i(c=r(c)));var y=JSON.stringify(n(this,h));o(this,h,c),o(this,d,n(this,d)+u),l&&y!==JSON.stringify(n(this,h))&&(s(this,S,J).call(this),"win"!==n(this,v)&&s(this,p,O).call(this),s(this,b,L).call(this))}}function J(){var t=!0,e=!1,r=void 0;try{for(var i,a=n(this,h)[Symbol.iterator]();!(t=(i=a.next()).done);t=!0)if(i.value.includes(2048)){o(this,v,"win");return}}catch(t){e=!0,r=t}finally{try{t||null==a.return||a.return()}finally{if(e)throw r}}}function L(){if(!n(this,h).flat().includes(0)){for(var t=0;t<4;t++)for(var e=0;e<4;e++){var r=n(this,h)[t][e];if(t<3&&n(this,h)[t+1][e]===r||e<3&&n(this,h)[t][e+1]===r)return}o(this,v,"lose")}}var E=new((t=/*#__PURE__*/function(){var t;function e(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),l(this,m),l(this,p),l(this,g),l(this,w),l(this,S),l(this,b),a(this,h,{writable:!0,value:void 0}),a(this,d,{writable:!0,value:void 0}),a(this,v,{writable:!0,value:void 0}),a(this,y,{writable:!0,value:void 0}),o(this,y,t||s(this,m,k).call(this)),o(this,h,JSON.parse(JSON.stringify(n(this,y)))),o(this,d,0),o(this,v,"idle"),console.log(t)}return t=[{key:"moveLeft",value:function(){s(this,w,N).call(this,"left")}},{key:"moveRight",value:function(){s(this,w,N).call(this,"right")}},{key:"moveUp",value:function(){s(this,w,N).call(this,"up")}},{key:"moveDown",value:function(){s(this,w,N).call(this,"down")}},{key:"getScore",value:function(){return n(this,d)}},{key:"getState",value:function(){return JSON.parse(JSON.stringify(n(this,h)))}},{key:"getStatus",value:function(){return n(this,v)}},{key:"start",value:function(){("idle"===n(this,v)||"lose"===n(this,v))&&(o(this,h,JSON.parse(JSON.stringify(n(this,y)))),s(this,p,O).call(this),s(this,p,O).call(this),o(this,d,0),o(this,v,"playing"))}},{key:"restart",value:function(){o(this,h,JSON.parse(JSON.stringify(n(this,y)))),o(this,d,0),o(this,v,"playing"),s(this,p,O).call(this),s(this,p,O).call(this)}}],function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(e.prototype,t),e}())&&t.__esModule?t.default:t),W=document.querySelector(".button"),M=document.querySelector(".game-score"),T=document.querySelectorAll(".field-cell"),j=document.querySelector(".message-start"),q=document.querySelector(".message-win"),C=document.querySelector(".message-lose");function R(){var t=E.getState().flat();T.forEach(function(e,r){var n=t[r];e.textContent=n||"",e.className="field-cell",n&&e.classList.add("field-cell--".concat(n))}),M.textContent=E.getScore(),j.classList.add("hidden"),q.classList.add("hidden"),C.classList.add("hidden");var e=E.getStatus();"idle"===e?j.classList.remove("hidden"):"win"===e?q.classList.remove("hidden"):"lose"===e&&C.classList.remove("hidden")}W.addEventListener("click",function(){"idle"===E.getStatus()?(E.start(),W.textContent="Restart",W.classList.remove("start"),W.classList.add("restart")):E.restart(),R()}),document.addEventListener("keydown",function(t){switch(t.key){case"ArrowLeft":E.moveLeft();break;case"ArrowRight":E.moveRight();break;case"ArrowUp":E.moveUp();break;case"ArrowDown":E.moveDown();break;default:return}R()}),R()}();
//# sourceMappingURL=index.17ac6c80.js.map
